// naff.js - version: (please see package.js) - author: Paul Smith - license: MIT
var naff=function(){"use strict";"undefined"!=typeof rivets&&rivets.configure({prefix:"naff",preloadData:!0,rootInterface:".",templateDelimiters:["{{","}}"],handler:function(b,c,d){for(var b=a(b),e=d.keypath.replace(")","").split("("),f=e[1].split(","),h=0;h<f.length;h++)f[h]=g(f[h],b);f.unshift(c),b[e[0]].apply(b,f)}});var a=function(a){if(a=h(a),!a)throw"Origin not found, please add starting point for scope lookup";for(var b=a;b.tagName&&!b.scope;)b=b.parentNode;return b.scope?b.scope:"[object ShadowRoot]"===b.toString()?b.host.scope:null},b=function(b,c){if(b=h(b),!b)throw"Origin not specified, please add starting point for scope lookup";for(var d=a(b).parentNode;!(!d.tagName||c&&d.tagName==c.toUpperCase()&&d.scope||!c&&d.scope);)d=d.parentNode;return d.scope?d.scope:"[object ShadowRoot]"===d.toString()?d.host.scope:null},c=function(a){var b=Object.create(HTMLElement.prototype),c=document._currentScript.ownerDocument.querySelector("#"+a.name);b.createdCallback=function(){if(this.scope=e(a),c){d(this,c,a.shadowDom,a.dataBind),this.scope.template=this.shadowRoot?this.shadowRoot:this;var b=this.scope.host=this;this.scope.fire||(this.scope.fire=function(a,c){naff.fire.call(b,null,a,c)})}a.created&&this.scope.created()},b.attachedCallback=function(){a.attached&&this.scope.attached()},b.detachedCallback=function(){a.detached&&this.scope.detached()},b.attributeChangedCallback=function(b,c,d){a.attributeChanged&&this.scope.attributeChanged(b,c,d)};var f={prototype:b};a.extends&&(f.extends=a.extends),document.registerElement(a.name,f)},d=function(a,b,c,d){if(a=i(a),!a)throw"Host custom element not specified, please add custom element reference or lookup";var e=!!c,f=a.hasAttribute("data-bind")||!!d,g=b.content.querySelectorAll("content[select]"),h=b.content.querySelector("content");if(g.length>0){for(var j={},k=0;k<g.length;k++)if(g[k].hasAttribute("select")){var l=g[k].getAttribute("select");j[l]=a.querySelector(l)}if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML}else a.innerHTML=b.innerHTML;for(var n in j){var o=e?m.querySelector("content[select="+n+"]"):a.querySelector("content[select="+n+"]");o.parentNode.insertBefore(j[n],o),o.parentNode.removeChild(o)}}else if(h){var j=a.innerHTML;if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML}else a.innerHTML=b.innerHTML;var o=e?m.querySelector("content"):a.querySelector("content");o.innerHTML=j;for(var p=document.createDocumentFragment();o.firstChild;)p.appendChild(o.firstChild);o.parentNode.replaceChild(p,o)}else if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML,"undefined"!=typeof window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.assert(m)}else a.innerHTML=b.innerHTML;f&&"undefined"!=typeof rivets&&rivets.bind(e?m:a,a.scope)},e=function(a){if(null===a||"[object Object]"!==a.toString())return a;var b=a.constructor();for(var c in a)b[c]=e(a[c]);return b},f=function(a,b,c){a||(a=this);var d=c?new CustomEvent(b,{detail:c}):new Event(b);a.dispatchEvent(d)},g=function(a,b){if(a){if(a=a.trim(),/^[0-9]+$/i.test(a))return parseInt(a);if("true"==a||"false"==a)return"true"===a?!0:!1;if("null"==a)return null;if(/^(\'|\"){1}.*(\'|\"){1}$/.test(a))return a.substring(1,a.length-1);for(var c=a.split("."),d=b,e=0;e<c.length;e++)for(var f=c[e].split("["),g=0;g<f.length;g++){var h=/^[0-9 ]+$/i.test(f[g])?parseInt(f[g].replace(/[ ]/g,"")):f[g].replace(/[\'\"\] ]/g,"");d=d?d[h]:d}return d}},h=function(a){switch(typeof a){case"undefined":return null;case"string":return document.querySelector(a);case"object":return a.scope?a.parentNode:a}},i=function(a){switch(typeof a){case"undefined":return null;case"string":return document.querySelector(a);case"object":return a}};return{getScope:a,getParentScope:b,registerElement:c,applyTemplate:d,cloneObject:e,fire:f}}();