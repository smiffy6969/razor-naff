// naff.js - version: (please see package.js) - author: Paul Smith - license: MIT
rivets&&rivets.configure({prefix:"naff",preloadData:!0,rootInterface:".",templateDelimiters:["{{","}}"],handler:function(a,b,c){for(var a=getScope(a),d=c.keypath.replace(")","").split("("),e=d[1].split(","),f=0;f<e.length;f++)e[f]=_parseData(e[f],a);e.unshift(b),a[d[0]].apply(a,e)}});var naff=function(){"use strict";var a=function(a){if(a=g(a),!a)throw"Origin not found, please add starting point for scope lookup";for(var b=a;b.tagName&&!b.scope;)b=b.parentNode;return b.scope?b.scope:"[object ShadowRoot]"===b.toString()?b.host.scope:null},b=function(b,c){if(b=g(b),!b)throw"Origin not specified, please add starting point for scope lookup";for(var d=a(b).parentNode;!(!d.tagName||c&&d.tagName==c.toUpperCase()&&d.scope||!c&&d.scope);)d=d.parentNode;return d.scope?d.scope:"[object ShadowRoot]"===d.toString()?d.host.scope:null},c=function(a){var b=Object.create(HTMLElement.prototype),c=document._currentScript.ownerDocument.querySelector("#"+a.name);b.createdCallback=function(){this.scope=e(a),c&&(d(this,c,a.shadowDom,a.dataBind),this.scope.template=this.shadowRoot?this.shadowRoot:this,this.scope.host=this),a.created&&this.scope.created()},b.attachedCallback=function(){a.attached&&this.scope.attached()},b.detachedCallback=function(){a.detached&&this.scope.detached()},b.attributeChangedCallback=function(b,c,d){a.attributeChanged&&this.scope.attributeChanged(b,c,d)};var f={prototype:b};a.extends&&(f.extends=a.extends),document.registerElement(a.name,f)},d=function(a,b,c,d){if(a=h(a),!a)throw"Host custom element not specified, please add custom element reference or lookup";var e=a.hasAttribute("shadow-dom")||!!c,f=a.hasAttribute("data-bind")||!!d,g=b.content.querySelectorAll("content[select]"),i=b.content.querySelector("content");if(g.length>0){for(var j={},k=0;k<g.length;k++)if(g[k].hasAttribute("select")){var l=g[k].getAttribute("select");j[l]=a.querySelector(l)}if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML}else a.innerHTML=b.innerHTML;for(var n in j){var o=e?m.querySelector("content[select="+n+"]"):a.querySelector("content[select="+n+"]");o.parentNode.insertBefore(j[n],o),o.parentNode.removeChild(o)}}else if(i){var j=a.innerHTML;if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML}else a.innerHTML=b.innerHTML;var o=e?m.querySelector("content"):a.querySelector("content");o.innerHTML=j;for(var p=document.createDocumentFragment();o.firstChild;)p.appendChild(o.firstChild);o.parentNode.replaceChild(p,o)}else if(e){var m=a.createShadowRoot();m.innerHTML=b.innerHTML}else a.innerHTML=b.innerHTML;f&&rivets&&rivets.bind(e?m:a,a.scope)},e=function(a){if(null===a||"[object Object]"!==a.toString())return a;var b=a.constructor();for(var c in a)b[c]=e(a[c]);return b},g=function(a){switch(typeof a){case"undefined":return null;case"string":return document.querySelector(a);case"object":return a.scope?a.parentNode:a}},h=function(a){switch(typeof a){case"undefined":return null;case"string":return document.querySelector(a);case"object":return a}};return{getScope:a,getParentScope:b,registerElement:c,cloneObject:e}}();